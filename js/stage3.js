var map;
var mapaLevel3 = [
    [-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,18, 7, 7, 7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1, 7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],
    [-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1, 2, 7, 5, 7, 7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1, 7,-1,-1,-1,-1,-4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],
    [ 1, 7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,18,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1, 2, 3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1, 2, 7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1, 7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],
    [ 0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1, 2, 7,-1,-1,-1,-1,-1,-1,-1,-1,-1, 4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1, 2, 7, 7,-1,-1,-1,-1, 2, 7, 7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1, 7, 7,-1,-1,-1,-1,-1,-1, 7, 3,-1,-1,-1, 7, 7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1, 7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],
    [ 0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1, 2, 5, 7,-1,-1,-1,-1,-1,-1,-1,-1, 7, 7, 7, 7, 7,17, 7, 7, 7, 3,-1,-1,-1, 7, 7, 1, 7, 7, 0, 1, 1,-1, 1, 7, 1, 7, 5, 7, 7,18,-1, 2, 3,-1,-1,-1, 2, 7, 7, 5, 7, 7, 7, 5, 7, 7,-1,-1,-1, 7, 7, 7,-1, 7, 2, 6,-1, 7,-1,-1,-1,-1, 7, 7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1, 7,-1,-1,-1,-1,-1,-1,-1,-1, 7,-1,-1,-1,-1,-1,-1,-1, 7,-1,-1,-1,-1,-1, 7,-1,-1,-1,-1,-1, 7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],
    [ 3, 0, 8, 0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1, 2, 7, 7, 0,-1,-1,-1,-1,-1,-1,-1, 7, 7, 1, 0, 0, 0, 7, 5, 7, 5, 7,-1,-1,-1, 0, 7, 7, 7,-1,-1,-1,-1,-1,-1,-1,-1, 7, 7, 7, 0,-1,-1,-1,-1,-1,-1, 0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1, 7, 7, 7, 7, 7,-1,-1,-1,-1,-1,-1,-1, 7,-1,-1,-1,-1,-1, 7, 7, 7, 7, 4, 7, 7, 7,-1,-1, 7,-1,-1, 7,-1,-1, 4,-1,-1, 7,-1,-1, 7,-1,-1, 7,-1,-1,18,-1,-1, 2, 7, 7, 7, 7, 7, 7],
    [ 0, 4, 7, 7, 1, 7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1, 2, 7, 7, 7, 0,-1,-1,-1,-1,-1,-1, 1, 7, 7, 7, 7,-1,-1, 7,-1,-1, 7, 5,-1,-1,-1, 0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1, 7, 1, 7, 5, 7, 2, 7, 2,-1,-1,-1, 7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1, 7,-1,-1, 7,-1,-1, 7,-1,-1, 7,-1,-1, 0,-1,-1, 0,-1,-1,18,-1,-1, 7,-1, 7, 7, 7, 7, 7, 7, 7, 7],
    [ 5, 7, 1, 7,18, 7, 7, 6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1, 2, 5, 7, 5, 7, 0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1, 7, 5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1, 2, 7, 5, 5, 7, 7,-1,-1,-1,-1,-1,-1, 1, 7, 7, 7, 0, 7, 7, 7, 7,-1, 7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1, 7,-1,-1, 7,-1,-1, 7,-1,-1, 7,-1,-1, 0,-1,-1, 1,-1,-1, 7,-1,-1, 7, 7, 7, 7, 7, 7, 6, 7, 7, 7],
    [ 0, 7, 7, 7, 7, 7,17, 6, 6, 7, 0, 0, 7,18, 7, 7,-1,-1, 2, 7, 7, 7, 7, 7, 7, 5,-1,-1, 7, 7, 7, 7, 5, 7, 7, 7, 7, 5, 7, 7, 7, 7, 5, 7,-1,-1, 7, 7, 7, 5, 7, 7, 7,17, 7, 7, 7, 5, 7, 7, 5, 7, 7,17, 7, 7, 7, 7, 7,-1,-1,-1,-1,-1,-1,-1,-1, 7, 7, 5, 7, 7, 5, 7, 7, 5, 7, 6, 7, 7, 7, 3, 7, 7, 1, 7, 7, 7, 7, 6, 7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1, 7, 7, 7, 7, 7, 4, 7, 7, 7, 4, 7, 7, 7, 7, 7,18, 7, 7, 5, 7, 7, 6, 7, 7, 6, 7, 7, 7, 6, 7, 7]
];

function getThirdLevel(game, player) {
    console.log("Tercer nivel cargado (Ya casi acabas)");
    var stage = new Group();
    map = new Map(32, 32);

    //if (game.clearBackground) { game.clearBackground(); }

    var bg = new Sprite(3280, 480);
    bg.image = game.assets['assets/story-scenes/010-redisbad.png'];

    /*var leafs = new Sprite(640, 96);
     leafs.image = game.assets['assets/bright-roof.png'];

     var leafs2 = new Sprite(640, 96);
     leafs2.image = game.assets['assets/bright-roof-2.png'];
     */
    game.rootScene.addChild(bg);
    game.bg = bg;
    /*
     game.leafs = leafs;
     game.leafs2 = leafs2;
     */
    game.map = map;
    game.stage = stage;
    game.currentLevel = 3;

    map.image = game.assets['assets/map-noir.png'];
    map.loadData(mapaLevel3);

    player.x = 64;
    player.y = 0;
    player.jumpcnt = 9;
    player.life = 6;

    player.resetPlayer();

    stage.finalPosition = 4700;
    stage.addChild(map);
    stage.addChild(player);

    //leafs.tl.fadeOut(70).fadeIn(70).loop();

    window.healthbar = new HealthBar({
        stage  : stage
    });

    game.showMessage('assets/messages/mentira.png');

    /*
     // Cherries.
     var cherries = [
     //	{x: 32, y: 45},
     ];

     for(var i=0; i< cherries.length; i++) {
     stage.addChild(new Fruit({
     image: game.assets['assets/powerups/bright/cherry-sprite.png'],
     player: player,
     map: self.map,
     width: 16,
     height: 16,
     x: cherries[i].x,
     y: cherries[i].y,
     val: 1,
     stage: stage,
     game: game
     }));
     }
     */

    stage.addChild(new Enemy(32 * 8, 32 * 7, 32 , 'zombie', 4, 1, true, 7));
    stage.addChild(new Enemy(32 * 23, 32 * 3, 32 , 'zombie', 4, 1, true, 7));
    stage.addChild(new Enemy(32 * 21, 32 * 5, 32 , 'zombie', 4, 1, true, 7));
    stage.addChild(new Enemy(32 * 37, 32 * 6, 32 , 'bee', 10, 0, true));
    stage.addChild(new Enemy(32 * 37, 32 * 6, 16 , 'bee', 10, 0, true));

    stage.addChild(new Enemy(32 * 39, 32 * 6, 32 , 'bee', 10, 0, true));
    stage.addChild(new Enemy(32 * 39, 32 * 6, 16 , 'bee', 10, 0, true));

    stage.addChild(new Enemy(32 * 54, 32 * 6, 32 , 'zombie', 4, 1, true, 7));
    stage.addChild(new Enemy(32 * 60, 32 * 7, 32 , 'zombie', 2, 1, true, 7));

    stage.addChild(new Enemy(32 * 57, 32 * 3, 32 , 'zombie', 5, 1, true, 7));


    stage.addChild(new Enemy(32 * 70, 32 * 3, 32 , 'zombie', 2, 1, true, 7));

    stage.addChild(new Enemy(32 * 86, 32 * 7, 32 , 'zombie', 2, 1, true, 7));
    stage.addChild(new Enemy(32 * 91, 32 * 7, 32 , 'zombie', 2, 1, true, 7));
    stage.addChild(new Enemy(32 * 88, 32 * 3, 32 , 'zombie', 1, 1, true, 7));

    /*<<<<<<< HEAD*/

    stage.addChild(new Enemy(32 * 108, 32 * 5, 32 , 'honeycomb', 0, 0, true));
    stage.addChild(new Enemy(32 * 115, 32 * 4, 32 , 'bee', 10, 0, true));
    stage.addChild(new Enemy(32 * 109, 32 * 4, 16 , 'bee', 10, 0, true));
    stage.addChild(new Enemy(32 * 112, 32 * 4, 16 , 'bee', 8, 0, true));

    stage.addChild(new Enemy(32 * 35, 32 * 2, 32 , 'zombie', 4, 5, true, 7));
    stage.addChild(new Enemy(32 * 33, 32 * 4, 32 , 'zombie', 4, 7, true, 7));
    stage.addChild(new Enemy(32 * 53, 32 * 3, 32 , 'zombie', 7, 7, true, 7));

    stage.addChild(new Enemy(32 * 63, 32 * 5, 32 , 'honeycomb', 0, 0, true));

    stage.addChild(new Enemy(32 * 59, 32 * 6, 16 , 'bee', 10, 0, true));
    stage.addChild(new Enemy(32 * 63, 32 * 6, 16 , 'bee', 8, 0, true));
    stage.addChild(new Enemy(32 * 62, 32 * 7, 16 , 'bee', 7, 0, true));
    stage.addChild(new Enemy(32 * 53, 32 * 7, 32 , 'zombie', 7, 7, true, 7));
    stage.addChild(new Enemy(32 * 57, 32 * 7, 32 , 'zombie', 6, 6, true, 7));
    stage.addChild(new Enemy(32 * 57, 32 * 7, 32 , 'zombie', 6, 6, true, 7));
    stage.addChild(new Enemy(32 * 59, 32 * 7, 32 , 'zombie', 7, 7, true, 7));

    /*El final*/

    stage.addChild(new Enemy(32 * 120, 32 * 7, 32 , 'zombie', 5, 7, true, 7));
    //stage.addChild(new Enemy(32 * 123, 32 * 7, 32 , 'zombie', 13, 6, true, 7));
    stage.addChild(new Enemy(32 * 123, 32 * 5, 16 , 'bee', 11, 0, true));
    stage.addChild(new Enemy(32 * 124, 32 * 6, 16 , 'bee', 5, 0, true));

    stage.addChild(new Enemy(32 * 127, 32 * 7, 32 , 'zombie', 13, 6, true, 7));

    //stage.addChild(new Enemy(32 * 129, 32 * 7, 32 , 'zombie', 10, 6, true, 7));
    stage.addChild(new Enemy(32 * 129, 32 * 5, 16 , 'bee', 8, 0, true));
    stage.addChild(new Enemy(32 * 130, 32 * 6, 16 , 'bee', 10, 0, true));
    stage.addChild(new Enemy(32 * 129, 32 * 7, 16 , 'bee', 14, 0, true));

    stage.addChild(new Enemy(32 * 132, 32 * 7, 32 , 'zombie', 8, 6, true, 7));
    stage.addChild(new Enemy(32 * 133, 32 * 7, 32 , 'zombie', 5, 6, true, 7));

    stage.addChild(new Enemy(32 * 135, 32 * 7, 32 , 'zombie', 12, 6, true, 7));
    stage.addChild(new Enemy(32 * 136, 32 * 7, 32 , 'zombie', 8, 6, true, 7));
    stage.addChild(new Enemy(32 * 135, 32 * 6, 16 , 'bee', 8, 0, true));
    stage.addChild(new Enemy(32 * 136, 32 * 5, 16 , 'bee', 10, 0, true));

    stage.addChild(new Enemy(32 * 138, 32 * 7, 32 , 'zombie', 12, 6, true, 7));
    stage.addChild(new Enemy(32 * 139, 32 * 7, 32 , 'zombie', 8, 6, true, 7));
    stage.addChild(new Enemy(32 * 139, 32 * 5, 16 , 'bee', 8, 0, true));
    stage.addChild(new Enemy(32 * 138, 32 * 6, 16 , 'bee', 10, 0, true));

    return stage;
}
